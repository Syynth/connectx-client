req = require 'superagent'
{ApiUrl} = require 'connectx/constants'
{CurrentUserStore, PostStore} = require 'connectx/stores'
stub = require './stubHelpers'
_ = require 'lodash'

module.exports =
  createPost: (post, cb) ->
    post.id = "ServerStub#{Math.random()}"
    _.delay (-> cb stub.getRandomError(0.1), post), stub.getNetworkDelay()
    ###
    req.post "#{ApiUrl}/post"
      .type 'json'
      .type 'CONNECTX-AUTH'
      .send PostStore.trim post # removes client-side only properties
      .end (err, res) ->
        unless res.error
          cb null, res.body
        else
          cb res.error
    ###
