NotificationActionCreators = require 'connectx/actions/notificationActionCreators'
req = require 'superagent'
{ApiUrl} = require 'connectx/constants'

module.exports =
  postLogin: (user, cb) ->
    req.post "#{ApiUrl}/login"
      .type 'form'
      .withCredentials()
      .send user
      .end (err, res) ->
        unless res.error
          cb res.body
        else
          NotificationActionCreators.postNotification
            message: "Login failed: #{res.error.message}"
            detail: res.error.message
            status: 'failure'
  postRegister: (user) ->
    req.post "#{ApiUrl}/register"
      .send user
      .end (err, res) ->
        unless res.error
          NotificationActionCreators.postNotification
            message: 'Account successfully created. Please verify by checking your email'
        else
          console.log err
          NotificationActionCreators.postNotification
            message: "Registration failed: #{res.error.message}"
            status: 'failure'
