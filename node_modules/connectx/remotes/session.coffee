NotificationActionCreators = require 'connectx/actions/notificationActionCreators'
req = require 'superagent'
{ApiUrl} = require 'connectx/constants'

module.exports =
  postLogin: (user, cb) ->
    req.post "#{ApiUrl}/login"
      .type 'form'
      .withCredentials()
      .send user
      .end (err, res) ->
        unless res.error
          cb res.body
        else
          NotificationActionCreators.postNotification
            message: 'Login failed!'
            detail: res.error.message
            status: 'failure'
