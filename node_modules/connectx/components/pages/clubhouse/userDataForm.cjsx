# @cjsx React.DOM

React = require 'react'
_ = require 'lodash'
{SessionActionCreators, CurrentUserActionCreators} = require 'connectx/actions'
{Navigation} = require 'react-router'

UserDataForm = module.exports = React.createClass
  mixins: [Navigation]
  logout: ->
    SessionActionCreators.logout()
    @transitionTo 'home'
  updateUser: (ev) ->
    diff = {}
    diff[ev.target.name] = ev.target.value
    CurrentUserActionCreators.updateUser _.extend {}, @props.user, diff
  render: ->
    <form className="form listview settings">
      <p className="generic">
        <span className="col2 first">
          <label for="name">Full Name</label>
          <input ref="name" maxlength="20" name="name" onChange={@updateUser} placeholder="Full name" type="text" value={@props.user.name} />
        </span>
      </p>
      <p className="generic">
        <span className="col1">
          <label for="about_text">About me</label>
          <input name="about_text" onChange={@updateUser} placeholder="tell us about yourself" type="text" value={@props.user.about_text} />
        </span>
      </p>
      <div className="generic">
        <section className="col3">
          <label for="city">City</label>
          <input name="city" placeholder="" type="text" />
        </section>
        <section className="col3">
          <label for="state">State</label>
          <input name="state" type="text" />
        </section>
        <section className="col3">
          <label for="zip">Zip</label>
          <input name="zip" placeholder="" type="text" />
        </section>
      </div>
      <div className="clearfix"></div>
      <p className="generic">
        <button className="save saveSettings">
          <i className="fa fa-check" />
          Save Changes
        </button>
        <a className="logout" onClick={@logout}>
          <i className="fa fa-sign-out"></i>
          Logout
        </a>
      </p>
    </form>
