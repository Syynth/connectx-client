# @cjsx React.DOM

React = require 'react'
Header = require '../header'
Footer = require '../footer'
Main = require '../main'
ClubhouseHeader = require './clubhouse/header'
{CurrentUserStore} = require 'connectx/stores'
StoreListener = require 'connectx/mixins/storeListener'
{RouteHandler} = require 'react-router'


Clubhouse = module.exports = React.createClass
  mixins: [StoreListener CurrentUserStore]
  onChange: -> @forceUpdate()
  statics:
    willTransitionTo: (transition, element) ->
      unless CurrentUserStore.isLoggedIn()
        transition.redirect 'home'
  render: ->
    <div className="body_wrapper">
      <Header><ClubhouseHeader current={true} user={CurrentUserStore.getCurrentUser()} /></Header>
      <Main>
        <RouteHandler />
      </Main>
      <Footer />
    </div>
