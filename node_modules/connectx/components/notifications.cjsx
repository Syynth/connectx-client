# @cjsx React.DOM

React = require 'react/addons'
{NotificationStore} = require 'connectx/stores'
StoreListener = require 'connectx/mixins/storeListener'
{NotificationActionCreators} = require 'connectx/actions'

Notification = React.createClass
  destroy: -> NotificationActionCreators.removeNotification @props
  render: ->
    classes = React.addons.classSet
      notification: true
      success: @props.status is 'success'
      failure: @props.status is 'failure'
    <section>
      <article className={classes}>
        <span>{@props.message}</span>
        <button className="btn close" onClick={@destroy}>Ã—</button>
      </article>
    </section>

Notifications = module.exports = React.createClass
  mixins: [StoreListener NotificationStore]
  onChange: -> @forceUpdate()
  render: ->
    <div id="applicationNotificationRegion">
      {NotificationStore.getAll().map (n) -> React.createElement Notification, n}
    </div>
