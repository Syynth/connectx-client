# @cjsx React.DOM

React = require 'react'
{PostActionCreators} = require 'connectx/actions'
{SwallowEvent} = require 'connectx/mixins'

PostForm = module.exports = React.createClass
  getInitialState: -> loading: false, type: 'text', text: ''
  mixins: [SwallowEvent]
  updateText: (e) ->
    @setState text: e.target.value
  postMessage: (e) ->
    e.preventDefault()
    #if @state.type is 'text'
    PostActionCreators.createPost {text: @state.text, author: @props.current, owner: @props.entity}
    @setState text: ''
  render: ->
    <div>
      <div className="comments_wrapper">
        <div className="c_header" />
        <div className="c_body">
          <div className="c_body_container">
            <form className="post-form" onSubmit={@swallowEvent}>
              <textarea className="comment" value={@state.text} onChange={@updateText} placeholder="Whats on your mind?" ref="postText" />
              <article className="post_bar_bottom">
                <div className="left_btn partition">
                  <figure className="postFigure">
                    <img className="preview preview-file">
                  </figure>
                  <input className="add_img hideItem input-file" id="photo" name="photo" type="file" />
                  <label className="add_img photo-btn" for="photo">
                    <i className="centerIcon fa fa-camera" />
                    {
                      if @state.loading
                        <article className="loader">loading...</article>
                    }
                  </label>
                  <div className="clearfix" />
                </div>
                <div className="partition right_btn">
                  <button className="submit_comment" onClick={@postMessage}>POST</button>
                  <div className="clearfix" />
                </div>
                <div className="clearfix" />
              </article>
            </form>
          </div>
        </div>
      </div>
    </div>
