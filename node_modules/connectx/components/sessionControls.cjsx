# @cjsx React.DOM

React = require 'react'
{CurrentUserStore} = require 'connectx/stores'
{ModalTrigger} = require 'react-bootstrap'
LoginModal = require './loginModal'
RegisterModal = require './registerModal'
{SessionActionCreators} = require 'connectx/actions'
StoreListener = require 'connectx/mixins/storeListener'

getStateFromStore = -> isLoggedIn: CurrentUserStore.isLoggedIn()

SessionsControls = module.exports = React.createClass
  mixins: [StoreListener CurrentUserStore]
  getInitialState: getStateFromStore
  onChange: -> @setState getStateFromStore()
  logout: -> SessionActionCreators.logout()
  render: ->
    if @state.isLoggedIn
      <ul className="buttonRow">
          <li className="logout" onClick={@logout}>Logout</li>
      </ul>
    else
      <ul className="buttonRow">
        <ModalTrigger modal={<LoginModal />}>
          <li className="login">Login</li>
        </ModalTrigger>
        <ModalTrigger modal={<RegisterModal />}>
          <li className="register">Register</li>
        </ModalTrigger>
        <li className="facebook">
          <i className="fa fa-facebook-square" />
          Facebook
        </li>
      </ul>
