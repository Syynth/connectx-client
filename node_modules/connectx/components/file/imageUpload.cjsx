
React = require 'react'
guid = require 'guid'

module.exports = React.createClass
  getInitialState: -> imgSrc: ""
  updatePreview: (ev) ->
    el = ev.target
    if (el.files and el.files[0])
      reader = new FileReader()
      reader.onload = (e) =>
        @setState imgSrc: e.target.result
      reader.readAsDataURL el.files[0]
  submit: (ev) ->
    ev.stopPropagation()
    ev.preventDefault()
    
  render: ->
    id = guid.create()
    <div style={@props.style}>
      <figure className="preview-img-wrapper">
        <img ref="preview" className="preview-file" src={@state.imgSrc} />
      </figure>
      <section className="file">
        <input id={id} onChange={@updatePreview} className="input-file" type="file" />
        <label for={id}>Add a Photo</label>
      </section>
      <button onClick={@submit} className="submit-file button green">Upload</button>
    </div>
