
React = require 'react'
_ = require 'lodash'

{NotificationActionCreators, ConnectionActionCreators} = require 'connectx/actions'
{ConnectionStore} = require 'connectx/stores'
{AutoStoreListener} = require 'connectx/mixins'

module.exports = React.createClass
  mixins: [AutoStoreListener ConnectionStore]
  connectEntities: ->
    ConnectionActionCreators.createConnection @props.current, @props.entity
  shouldDraw: ->
    first = ConnectionStore.get @props.current.id, all: true
      .filter (e) => e.id is @props.entity.id
      .length is 0
    first and @props.current.id isnt @props.entity.id
  render: ->
    if (@shouldDraw())
      style =
        position: 'absolute'
        right: '1%'
        bottom: '2%'
        border: 'none'
      <button style={_.extend style, @props.style}
              onClick={@connectEntities}
              className="button connect_btn red addFriend">
        Add friend
      </button>
    else
      <div />
