
React = require 'react'
{State, Link} = require 'react-router'
{EntityActionCreators} = require 'connectx/actions'
{DebugProps, AutoStoreListener} = require 'connectx/mixins'

{UserStore, GroupStore, EventStore, CourseStore, getStore} = require 'connectx/stores'

module.exports = React.createClass
  mixins: [State, DebugProps, AutoStoreListener(UserStore), AutoStoreListener(GroupStore), AutoStoreListener(EventStore), AutoStoreListener(CourseStore)]
  componentDidMount: ->
    EntityActionCreators.searchEntities @props.entityType, @getParams().query
  render: ->
    reg = new RegExp(@getParams().query, 'i')
    entities = getStore(@props.entityType).query (e) -> reg.test e.name
    <div>
      <div>
        {
          entities.map (e) =>
            <div>
              <Link to={@props.entityType} params={id: e.id}><div>{e.name}</div></Link>
            </div>
        }
      </div>
    </div>
