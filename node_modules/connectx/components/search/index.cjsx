
React = require 'react'
{State, Link} = require 'react-router'
{EntityActionCreators} = require 'connectx/actions'
{DebugProps, AutoStoreListener} = require 'connectx/mixins'

{UserStore, GroupStore} = require 'connectx/stores'

lookup =
  user: UserStore
  group: GroupStore
  #user: require('connectx/stores').UserStore
  #user: require('connectx/stores').UserStore

module.exports = React.createClass
  mixins: [State, DebugProps, AutoStoreListener(UserStore)]
  getStore: -> lookup[@props.entityType]
  componentDidMount: ->
    EntityActionCreators.searchEntities @props.entityType, @getParams().query
  render: ->
    reg = new RegExp(@getParams().query, 'i')
    entities = lookup[@props.entityType].query (e) -> reg.test e.name
    <div>
      <div>
        {
          entities.map (e) =>
            <div>
              <Link to={@props.entityType} params={id: e.id}><div>{e.name}</div></Link>
            </div>
        }
      </div>
    </div>
