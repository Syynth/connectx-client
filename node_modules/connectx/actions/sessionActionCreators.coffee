
Dispatcher = require 'connectx/dispatcher'
Router = require 'connectx/router'
{ActionType} = require 'connectx/constants'

Session = null

recieveLoginSuccess = (user) ->
  Dispatcher.handleServerAction
    type: ActionType.UserLogin
    user: user

module.exports =
  logout: ->
    Dispatcher.handleClientAction
      type: ActionType.UserLogout
  tryLogin: (email, password) ->
    Dispatcher.handleClientAction
      type: ActionType.UserLogin
      email: email
      password: password
    Session.postLogin {email, password}, (usr) -> recieveLoginSuccess usr
  recieveLoginSuccess: recieveLoginSuccess

{Session} = require 'connectx/remotes'
