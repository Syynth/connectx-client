class Cache
  constructor: (@data = {}) ->
    @_mem = data

  # returns every item that is true for *predicate
  query: (predicate) ->
    @get key for key, val of @_mem when predicate val
  get: (key) ->
    return @data[key] if @data[key]
    return @data[key] = @_mem[key]
  set: (key, val) ->
    @data[key] = val
    @_mem[key] = val
  unset: (key, val) ->
    delete @data[key]
    delete @mem[key]
  clear: -> @data = {}

module.exports = Cache
