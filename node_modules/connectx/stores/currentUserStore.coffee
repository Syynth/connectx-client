
{EventEmitter} = require 'events'
Dispatcher = require 'connectx/dispatcher'
{SourceType, ActionType} = require 'connectx/constants'

BaseStore = require './baseStore'

currentUser = null

class CurrentUserStore extends BaseStore
  isLoggedIn: -> currentUser isnt null

store = module.exports = new CurrentUserStore

store.dispatchToken = Dispatcher.register (payload) ->
  return if payload.source is SourceType.Server
  switch payload.action.type
    when ActionType.UserLogin
      currentUser = payload.user
      store.emitChange()
    when ActionType.UserLogout
      currentUser = null
      store.emitChange()
    else
      # nothing
